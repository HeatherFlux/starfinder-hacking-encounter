@import "tailwindcss";

/* Paizo Pathfinder Icons Font - Action Symbols */
@font-face {
  font-family: 'Pathfinder-Icons';
  src: url('/fonts/Pathfinder-Icons.ttf') format('truetype');
  font-weight: normal;
  font-style: normal;
  font-display: swap;
}

/* Action icon class - uses ligatures */
.action-icon {
  font-family: 'Pathfinder-Icons', sans-serif;
  font-size: 1.1em;
  line-height: 1;
  vertical-align: middle;
  /* Enable ligatures - required for the font to work */
  font-variant-ligatures: common-ligatures discretionary-ligatures;
  font-feature-settings: "liga" 1, "dlig" 1;
  -webkit-font-feature-settings: "liga" 1, "dlig" 1;
  -moz-font-feature-settings: "liga" 1, "dlig" 1;
}

/* ============================================
   THEME - Angular Sci-Fi Design System
   Inspired by COMP/CON & mech interfaces
   ============================================ */
@theme {
  /* Core theme colors - Deep space with neon accents */
  --color-bg: #050608;
  --color-bg-surface: #0a0d10;
  --color-bg-elevated: #0f1318;
  --color-bg-hover: #161c24;

  --color-border: #1e2832;
  --color-border-hover: #2a3844;
  --color-border-focus: #1ECBE1;

  --color-text: #e8eef4;
  --color-text-dim: #7a8b9a;
  --color-text-muted: #4a5968;

  /* ===========================================
     TETRADIC COLOR PALETTE
     Based on primary cyan, 90Â° apart on wheel
     =========================================== */

  /* Primary - Cyan (UI, links, main accents) */
  --color-primary: #1ECBE1;
  --color-primary-dim: #18a2b4;
  --color-primary-bright: #5ce1ff;
  --color-primary-subtle: rgba(30, 203, 225, 0.12);

  /* Secondary - Purple (special, arcane, hazards) */
  --color-secondary: #961EE1;
  --color-secondary-dim: #7818b4;
  --color-secondary-bright: #b85cff;
  --color-secondary-subtle: rgba(150, 30, 225, 0.12);

  /* Tertiary - Coral/Red (controls, alerts, dials) */
  --color-tertiary: #E1341E;
  --color-tertiary-dim: #b42a18;
  --color-tertiary-bright: #ff5c47;
  --color-tertiary-subtle: rgba(225, 52, 30, 0.12);

  /* Quaternary - Green (success, health, confirms) */
  --color-quaternary: #6AE11E;
  --color-quaternary-dim: #55b418;
  --color-quaternary-bright: #8fff5c;
  --color-quaternary-subtle: rgba(106, 225, 30, 0.12);

  /* Legacy aliases (for backwards compatibility) */
  --color-accent: var(--color-primary);
  --color-accent-dim: var(--color-primary-dim);
  --color-accent-bright: var(--color-primary-bright);
  --color-accent-subtle: var(--color-primary-subtle);

  /* Semantic colors (mapped to tetradic) */
  --color-success: var(--color-quaternary);
  --color-success-dim: var(--color-quaternary-dim);
  --color-success-subtle: var(--color-quaternary-subtle);

  --color-warning: #ffaa00;
  --color-warning-dim: #cc8800;
  --color-warning-subtle: rgba(255, 170, 0, 0.12);

  --color-danger: var(--color-tertiary);
  --color-danger-dim: var(--color-tertiary-dim);
  --color-danger-subtle: var(--color-tertiary-subtle);

  /* Difficulty colors (PF2e encounter budgets) */
  --color-trivial: #4a5968;
  --color-low: var(--color-quaternary);
  --color-moderate: var(--color-primary);
  --color-severe: #ffaa00;
  --color-extreme: var(--color-tertiary);

  /* Special colors */
  --color-rollable: #ffcc00;
  --color-rollable-hover: #ffe566;
  --color-rollable-subtle: rgba(255, 204, 0, 0.12);

  --color-stat-label: var(--color-primary);
  --color-stat-value: #ffcc00;

  --color-hazard: var(--color-secondary);
  --color-hazard-subtle: var(--color-secondary-subtle);

  --color-player: #4ade80;
  --color-player-subtle: rgba(74, 222, 128, 0.12);

  /* Scrollbar colors */
  --color-scrollbar: rgba(0, 212, 255, 0.3);
  --color-scrollbar-hover: rgba(0, 212, 255, 0.5);
  --color-scrollbar-track: rgba(0, 0, 0, 0.2);

  /* Typography - Tech/Industrial feel */
  --font-sans: 'Inter', 'Roboto', system-ui, sans-serif;
  --font-mono: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
  --font-display: 'Orbitron', 'Inter', sans-serif;

  --text-2xs: 0.625rem;
  --text-xs: 0.6875rem;
  --text-sm: 0.75rem;
  --text-base: 0.8125rem;
  --text-md: 0.875rem;
  --text-lg: 1rem;
  --text-xl: 1.125rem;
  --text-2xl: 1.25rem;
  --text-3xl: 1.5rem;
  --text-4xl: 2rem;
  --text-5xl: 2.5rem;

  /* Border radius - Angular, minimal curves */
  --radius-sm: 2px;
  --radius: 2px;
  --radius-md: 3px;
  --radius-lg: 4px;
  --radius-xl: 6px;

  /* Angular cut size - EDIT THIS to change all chamfers */
  --chamfer-base: 12px;

  /* Derived sizes (proportional to base) */
  --cut-sm: calc(var(--chamfer-base) * 0.5);
  --cut-md: var(--chamfer-base);
  --cut-lg: calc(var(--chamfer-base) * 1.33);
  --cut-xl: calc(var(--chamfer-base) * 2);

  /* Shadows - Neon glow effects */
  --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.5);
  --shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
  --shadow-md: 0 8px 24px rgba(0, 0, 0, 0.6);
  --shadow-lg: 0 12px 32px rgba(0, 0, 0, 0.7);
  --shadow-glow-accent: 0 0 20px rgba(0, 212, 255, 0.4), 0 0 40px rgba(0, 212, 255, 0.2);
  --shadow-glow-success: 0 0 20px rgba(0, 255, 136, 0.4), 0 0 40px rgba(0, 255, 136, 0.2);
  --shadow-glow-danger: 0 0 20px rgba(255, 51, 102, 0.4), 0 0 40px rgba(255, 51, 102, 0.2);
  --shadow-glow-warning: 0 0 20px rgba(255, 170, 0, 0.4), 0 0 40px rgba(255, 170, 0, 0.2);
  --shadow-glow-hazard: 0 0 20px rgba(191, 95, 255, 0.4), 0 0 40px rgba(191, 95, 255, 0.2);

  /* Animations */
  --animate-pulse-slow: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  --animate-slide-in: slideIn 0.3s ease-out;
  --animate-slide-in-left: slideInLeft 0.3s ease-out;
  --animate-slide-down: slideDown 0.2s ease-out;
  --animate-slide-up: slideUp 0.2s ease-out;
  --animate-fade-in: fadeIn 0.15s ease-out;
  --animate-pop-in: popIn 0.2s ease-out;
  --animate-expand-down: expandDown 0.25s ease-out;
  --animate-shake: shake 0.4s ease-in-out;

  @keyframes slideIn {
    from { transform: translateX(100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
  }

  @keyframes slideInLeft {
    from { transform: translateX(-100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
  }

  @keyframes slideDown {
    from { transform: translateY(-10px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
  }

  @keyframes slideUp {
    from { transform: translateY(10px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes popIn {
    from { opacity: 0; transform: scale(0.95); }
    to { opacity: 1; transform: scale(1); }
  }

  @keyframes expandDown {
    from { opacity: 0; max-height: 0; transform: translateY(-10px); }
    to { opacity: 1; max-height: 2000px; transform: translateY(0); }
  }

  @keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-4px); }
    75% { transform: translateX(4px); }
  }
}

/* ============================================
   BASE STYLES - Global defaults & resets
   ============================================ */
@layer base {
  * {
    box-sizing: border-box;
  }

  html {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    scroll-behavior: smooth;
  }

  :root {
    font-family: var(--font-sans);
    line-height: 1.5;
    font-weight: 400;
  }

  body {
    background-color: var(--color-bg);
    color: var(--color-text);
    min-height: 100vh;
    margin: 0;
    position: relative;
  }

  /* Subtle CRT scan line effect - 10% opacity */
  body::after {
    content: '';
    position: fixed;
    inset: 0;
    background: repeating-linear-gradient(
      0deg,
      transparent,
      transparent 2px,
      rgba(0, 0, 0, 0.1) 2px,
      rgba(0, 0, 0, 0.1) 4px
    );
    pointer-events: none;
    z-index: 9999;
    opacity: 0.1;
    animation: scanlines 10s linear infinite;
  }

  @keyframes scanlines {
    0% { background-position: 0 0; }
    100% { background-position: 0 100vh; }
  }

  /* Custom scrollbars - themed */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    background: var(--color-scrollbar-track);
    border-radius: 4px;
  }

  ::-webkit-scrollbar-thumb {
    background: var(--color-scrollbar);
    border-radius: 4px;
    transition: background 0.2s ease;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: var(--color-scrollbar-hover);
  }

  ::-webkit-scrollbar-corner {
    background: transparent;
  }

  /* Firefox scrollbar */
  * {
    scrollbar-width: thin;
    scrollbar-color: var(--color-scrollbar) var(--color-scrollbar-track);
  }

  #app {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }

  /* Typography */
  h1, h2, h3, h4 {
    font-weight: 600;
    color: var(--color-text);
    line-height: 1.3;
    margin: 0;
  }

  h1 { font-size: var(--text-3xl); }
  h2 { font-size: var(--text-2xl); }
  h3 { font-size: var(--text-xl); }
  h4 { font-size: var(--text-lg); }

  p, span, div {
    margin: 0;
  }

  /* Custom scrollbars */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    background: var(--color-bg-surface);
  }

  ::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: 4px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: var(--color-text-dim);
  }

  /* Firefox scrollbars */
  * {
    scrollbar-width: thin;
    scrollbar-color: var(--color-border) var(--color-bg-surface);
  }
}

/* ============================================
   COMPONENTS - Reusable UI patterns
   ============================================ */
@layer components {
  /* ---------- Angular Clip Paths ---------- */
  .clip-angular {
    clip-path: polygon(
      var(--cut-sm) 0,
      100% 0,
      100% calc(100% - var(--cut-sm)),
      calc(100% - var(--cut-sm)) 100%,
      0 100%,
      0 var(--cut-sm)
    );
  }

  .clip-angular-md {
    clip-path: polygon(
      var(--cut-md) 0,
      100% 0,
      100% calc(100% - var(--cut-md)),
      calc(100% - var(--cut-md)) 100%,
      0 100%,
      0 var(--cut-md)
    );
  }

  .clip-angular-lg {
    clip-path: polygon(
      var(--cut-lg) 0,
      100% 0,
      100% calc(100% - var(--cut-lg)),
      calc(100% - var(--cut-lg)) 100%,
      0 100%,
      0 var(--cut-lg)
    );
  }

  .clip-angular-left {
    clip-path: polygon(
      var(--cut-md) 0,
      100% 0,
      100% 100%,
      0 100%,
      0 var(--cut-md)
    );
  }

  .clip-angular-right {
    clip-path: polygon(
      0 0,
      100% 0,
      100% calc(100% - var(--cut-md)),
      calc(100% - var(--cut-md)) 100%,
      0 100%
    );
  }

  /* ---------- Tech Panel Styles ---------- */
  .panel {
    background: var(--color-bg-surface);
    border: 1px solid var(--color-border);
    position: relative;
  }

  .panel::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, var(--color-accent), transparent);
  }

  .panel-glow {
    box-shadow:
      inset 0 1px 0 rgba(0, 212, 255, 0.1),
      0 0 20px rgba(0, 212, 255, 0.05);
  }

  /* Scan line overlay effect */
  .scanlines::after {
    content: '';
    position: absolute;
    inset: 0;
    background: repeating-linear-gradient(
      0deg,
      transparent,
      transparent 2px,
      rgba(0, 0, 0, 0.1) 2px,
      rgba(0, 0, 0, 0.1) 4px
    );
    pointer-events: none;
    opacity: 0.3;
  }

  /* Corner accents */
  .corner-accents {
    position: relative;
  }

  .corner-accents::before,
  .corner-accents::after {
    content: '';
    position: absolute;
    width: 12px;
    height: 12px;
    border: 2px solid var(--color-accent);
  }

  .corner-accents::before {
    top: -1px;
    left: -1px;
    border-right: none;
    border-bottom: none;
  }

  .corner-accents::after {
    bottom: -1px;
    right: -1px;
    border-left: none;
    border-top: none;
  }

  /* ---------- Buttons ---------- */
  /* Base button styles - applied to .btn and all variants */
  .btn,
  .btn-primary,
  .btn-secondary,
  .btn-danger,
  .btn-success {
    --btn-chamfer: var(--cut-lg);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    font-size: var(--text-md);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    border-radius: 0;
    transition: all 0.15s ease-out;
    cursor: pointer;
    border: 1px solid transparent;
    user-select: none;
    font-family: inherit;
    position: relative;
    /* Bottom-right chamfer - uses --btn-chamfer variable */
    clip-path: polygon(
      0 0,
      100% 0,
      100% calc(100% - var(--btn-chamfer)),
      calc(100% - var(--btn-chamfer)) 100%,
      0 100%
    );
  }

  /* Chamfer line */
  .btn::after,
  .btn-primary::after,
  .btn-secondary::after,
  .btn-danger::after,
  .btn-success::after {
    content: '';
    position: absolute;
    bottom: 0;
    right: 0;
    width: calc(var(--btn-chamfer) * 1.414);
    height: 1px;
    background: currentColor;
    transform-origin: bottom right;
    transform: rotate(-45deg) translateY(-0.5px);
    opacity: 0.5;
  }

  .btn:hover::after,
  .btn-primary:hover::after,
  .btn-secondary:hover::after,
  .btn-danger:hover::after,
  .btn-success:hover::after {
    opacity: 0.8;
  }

  .btn:focus,
  .btn-primary:focus,
  .btn-secondary:focus,
  .btn-danger:focus,
  .btn-success:focus {
    outline: none;
    box-shadow: var(--shadow-glow-accent);
  }

  /* Primary button */
  .btn-primary {
    background: var(--color-accent);
    color: var(--color-bg);
    border-color: var(--color-accent);
  }

  .btn-primary::after {
    background: rgba(0, 0, 0, 0.4);
    opacity: 1;
  }

  .btn-primary:hover {
    background: var(--color-accent-bright);
    box-shadow: var(--shadow-glow-accent);
  }

  .btn-primary:active {
    transform: scale(0.98);
  }

  /* Secondary button */
  .btn-secondary {
    background: var(--color-bg-elevated);
    color: var(--color-text);
    border: 1px solid var(--color-border);
  }

  .btn-secondary::after {
    background: var(--color-accent);
    opacity: 0.6;
  }

  .btn-secondary:hover {
    background: var(--color-bg-hover);
    border-color: var(--color-accent);
  }

  .btn-secondary:hover::after {
    opacity: 1;
  }

  /* Danger button */
  .btn-danger {
    background: var(--color-danger);
    color: white;
    border-color: var(--color-danger);
  }

  .btn-danger::after {
    background: rgba(255, 255, 255, 0.3);
  }

  .btn-danger:hover {
    background: var(--color-danger-dim);
    box-shadow: var(--shadow-glow-danger);
  }

  /* Success button */
  .btn-success {
    background: var(--color-success);
    color: var(--color-bg);
    border-color: var(--color-success);
  }

  .btn-success::after {
    background: rgba(0, 0, 0, 0.3);
  }

  .btn-success:hover {
    background: var(--color-success-dim);
    box-shadow: var(--shadow-glow-success);
  }

  /* Ghost button - no chamfer */
  .btn-ghost {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    font-size: var(--text-md);
    font-weight: 600;
    background: transparent;
    color: var(--color-text-dim);
    border: none;
    cursor: pointer;
    transition: all 0.15s ease-out;
  }

  .btn-ghost:hover {
    background: var(--color-bg-elevated);
    color: var(--color-text);
  }

  /* Button size modifiers - all use proportional chamfer from --chamfer-base */
  .btn-sm,
  .btn-primary.btn-sm,
  .btn-secondary.btn-sm,
  .btn-danger.btn-sm,
  .btn-success.btn-sm {
    --btn-chamfer: var(--cut-md);
    padding: 0.5rem 0.75rem;
    font-size: var(--text-sm);
  }

  .btn-xs,
  .btn-primary.btn-xs,
  .btn-secondary.btn-xs,
  .btn-danger.btn-xs,
  .btn-success.btn-xs {
    --btn-chamfer: var(--cut-sm);
    padding: 0.25rem 0.5rem;
    font-size: var(--text-xs);
  }

  /* Icon buttons */
  .btn-icon,
  .btn-primary.btn-icon,
  .btn-secondary.btn-icon,
  .btn-danger.btn-icon,
  .btn-success.btn-icon {
    --btn-chamfer: var(--cut-lg);
    padding: 0.5rem;
    aspect-ratio: 1;
  }

  .btn-icon-sm,
  .btn-primary.btn-icon-sm,
  .btn-secondary.btn-icon-sm,
  .btn-danger.btn-icon-sm,
  .btn-success.btn-icon-sm {
    --btn-chamfer: var(--cut-md);
    padding: 0.375rem;
    aspect-ratio: 1;
    font-size: var(--text-sm);
  }

  /* Icon button + sm combo - simple rounded */
  .btn-icon.btn-sm,
  .btn-primary.btn-icon.btn-sm,
  .btn-secondary.btn-icon.btn-sm,
  .btn-danger.btn-icon.btn-sm,
  .btn-success.btn-icon.btn-sm {
    width: 1.75rem;
    height: 1.75rem;
    padding: 0;
    font-size: var(--text-xl);
    font-weight: 600;
    line-height: 1;
    clip-path: none;
    border-radius: var(--radius-md);
  }

  .btn-icon.btn-sm::after,
  .btn-danger.btn-icon.btn-sm::after,
  .btn-success.btn-icon.btn-sm::after {
    display: none;
  }

  /* Compact square buttons - no chamfer, for tight spaces */
  .btn-compact,
  .btn-primary.btn-compact,
  .btn-secondary.btn-compact {
    padding: 0.375rem 0.5rem;
    font-size: var(--text-sm);
    min-width: 2rem;
    clip-path: none;
  }

  .btn-compact::after,
  .btn-primary.btn-compact::after,
  .btn-secondary.btn-compact::after {
    display: none;
  }

  /* ---------- Inputs ---------- */
  .input {
    width: 100%;
    padding: 0.5rem 0.75rem;
    font-size: var(--text-md);
    font-family: inherit;
    background: var(--color-bg-surface);
    color: var(--color-text);
    border: 1px solid var(--color-border);
    border-radius: var(--radius);
    transition: all 0.15s ease;
  }

  .input::placeholder {
    color: var(--color-text-muted);
  }

  .input:focus {
    outline: none;
    border-color: var(--color-accent);
    box-shadow: 0 0 0 3px rgba(88, 166, 255, 0.2);
  }

  .input-sm {
    padding: 0.375rem 0.625rem;
    font-size: var(--text-sm);
  }

  .input-ghost {
    background: transparent;
    border-color: transparent;
  }

  .input-ghost:hover {
    background: var(--color-bg-surface);
    border-color: var(--color-border);
  }

  .select {
    appearance: none;
    cursor: pointer;
    padding-right: 2rem;
    background-image: url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20stroke%3D%22%238b949e%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Cpath%20d%3D%22m6%209%206%206%206-6%22%2F%3E%3C%2Fsvg%3E');
    background-repeat: no-repeat;
    background-position: right 0.5rem center;
  }

  /* ---------- Cards ---------- */
  .card {
    background: var(--color-bg-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: 1rem;
    box-shadow: var(--shadow-sm);
    transition: all 0.2s ease;
    position: relative;
  }

  .card-elevated {
    background: var(--color-bg-elevated);
  }

  .card-interactive {
    cursor: pointer;
  }

  .card-interactive:hover {
    border-color: var(--color-border-hover);
    box-shadow: var(--shadow);
    background: var(--color-bg-elevated);
  }

  .card-selected {
    border-color: var(--color-accent);
    background: var(--color-accent-subtle);
    box-shadow: var(--shadow-glow-accent);
  }

  .card-glow:hover {
    box-shadow: var(--shadow-glow-accent);
    border-color: var(--color-accent);
  }

  /* ---------- Traits (PF2e style) ---------- */
  .trait {
    display: inline-block;
    padding: 0.125rem 0.5rem;
    font-size: var(--text-2xs);
    font-weight: 600;
    text-transform: uppercase;
    border-radius: 3px;
    background: var(--color-secondary);
    color: var(--color-bg);
    white-space: nowrap;
  }

  .trait-size { background: var(--color-primary); }
  .trait-alignment { background: var(--color-secondary); }
  .trait-rarity-uncommon { background: var(--color-tertiary); }
  .trait-rarity-rare { background: var(--color-quaternary); }
  .trait-rarity-unique { background: var(--color-primary); }
  .trait-creature-type { background: var(--color-quaternary); }

  /* ---------- Difficulty Badges ---------- */
  .badge-difficulty {
    display: inline-block;
    padding: 0.25rem 0.625rem;
    font-size: var(--text-sm);
    font-weight: 600;
    text-transform: uppercase;
    border-radius: var(--radius-sm);
    color: white;
    letter-spacing: 0.025em;
  }

  .badge-trivial { background: var(--color-trivial); }
  .badge-low { background: var(--color-low); }
  .badge-moderate { background: var(--color-moderate); }
  .badge-severe { background: var(--color-severe); }
  .badge-extreme { background: var(--color-extreme); }

  /* ---------- Level Badges ---------- */
  .badge-level {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 2rem;
    padding: 0.125rem 0.375rem;
    font-size: var(--text-xs);
    font-weight: 600;
    border-radius: var(--radius-sm);
    background: var(--color-bg-elevated);
    border: 1px solid var(--color-border);
    color: var(--color-text-dim);
  }

  .badge-level-danger {
    background: var(--color-danger-subtle);
    border-color: var(--color-danger);
    color: var(--color-danger);
  }

  .badge-level-warning {
    background: var(--color-warning-subtle);
    border-color: var(--color-warning);
    color: var(--color-warning);
  }

  .badge-level-success {
    background: var(--color-success-subtle);
    border-color: var(--color-success);
    color: var(--color-success);
  }

  .badge-level-accent {
    background: var(--color-accent-subtle);
    border-color: var(--color-accent);
    color: var(--color-accent);
  }

  /* ---------- Rollable Elements ---------- */
  .rollable {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    cursor: pointer;
    transition: all 0.15s ease;
    background: var(--color-rollable-subtle);
    border: 1px solid transparent;
  }

  .rollable:hover {
    background: rgba(255, 166, 87, 0.2);
    border-color: rgba(255, 166, 87, 0.5);
  }

  .rollable .roll-value,
  .rollable-value {
    color: var(--color-rollable);
    font-weight: 600;
  }

  .rollable:hover .roll-value,
  .rollable:hover .rollable-value {
    color: var(--color-rollable-hover);
  }

  .rollable-crit {
    background: rgba(239, 68, 68, 0.15);
    border-color: rgba(239, 68, 68, 0.3);
    color: var(--color-danger);
  }

  .rollable-crit:hover {
    background: rgba(239, 68, 68, 0.25);
    border-color: rgba(239, 68, 68, 0.5);
  }

  /* MAP (Multiple Attack Penalty) buttons */
  .map-btn {
    min-width: 2.25rem;
    text-align: center;
    font-weight: 600;
    color: var(--color-rollable);
  }

  .map-btn-secondary {
    background: rgba(255, 166, 87, 0.08);
    color: var(--color-dim);
  }

  .map-btn-secondary:hover {
    color: var(--color-rollable);
  }

  .map-btn-tertiary {
    background: rgba(255, 166, 87, 0.04);
    color: var(--color-muted);
  }

  .map-btn-tertiary:hover {
    color: var(--color-rollable);
  }

  .rollable .roll-label,
  .rollable-label {
    color: var(--color-text);
    font-weight: 500;
  }

  /* ---------- Modals ---------- */
  .modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(4px);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 50;
    animation: var(--animate-fade-in);
  }

  .modal {
    background: var(--color-bg-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: 1.5rem;
    width: 100%;
    max-width: 32rem;
    max-height: 90vh;
    overflow: auto;
    box-shadow: var(--shadow-lg);
    animation: var(--animate-pop-in);
  }

  .modal-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1rem;
    padding-bottom: 0.75rem;
    border-bottom: 1px solid var(--color-border);
  }

  .modal-title {
    font-size: var(--text-lg);
    font-weight: 600;
    color: var(--color-text);
  }

  /* ---------- Tabs ---------- */
  /* ---------- Nav Tabs (Angular Sci-Fi) ---------- */
  .nav-tab {
    padding: 0.625rem 1.25rem;
    font-size: var(--text-sm);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    transition: all 0.15s ease;
    color: var(--color-text-dim);
    cursor: pointer;
    background: var(--color-bg-elevated);
    border: none;
    position: relative;
    /* Bottom-right chamfer only - consistent with buttons */
    clip-path: polygon(
      0 0,
      100% 0,
      100% calc(100% - var(--cut-md)),
      calc(100% - var(--cut-md)) 100%,
      0 100%
    );
  }

  /* Border that follows the chamfer using inset box-shadow */
  .nav-tab::after {
    content: '';
    position: absolute;
    inset: 0;
    border: 1px solid var(--color-border);
    /* Match the chamfer with a diagonal line */
    clip-path: polygon(
      0 0,
      100% 0,
      100% calc(100% - var(--cut-md)),
      calc(100% - var(--cut-md)) 100%,
      0 100%
    );
    pointer-events: none;
    transition: border-color 0.15s ease;
  }

  .nav-tab:hover {
    color: var(--color-text);
    background: var(--color-bg-hover);
  }

  .nav-tab:hover::after {
    border-color: var(--color-border-hover);
  }

  .nav-tab-active {
    color: var(--color-accent);
    background: var(--color-bg-surface);
    box-shadow: var(--shadow-glow-accent);
  }

  .nav-tab-active::after {
    border-color: var(--color-accent);
  }

  .nav-tab-active::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: var(--color-accent);
    z-index: 1;
  }

  .nav-tab-live {
    color: var(--color-success);
    animation: pulse-border 2s ease-in-out infinite;
  }

  .nav-tab-live::after {
    border-color: var(--color-success);
  }

  @keyframes pulse-border {
    0%, 100% { box-shadow: 0 0 5px rgba(0, 255, 136, 0.3); }
    50% { box-shadow: 0 0 15px rgba(0, 255, 136, 0.5); }
  }

  /* ---------- Tabs ---------- */
  .tabs {
    display: flex;
    gap: 0.25rem;
    border-bottom: 1px solid var(--color-border);
  }

  .tab {
    padding: 0.625rem 1.25rem;
    font-size: var(--text-sm);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    transition: all 0.15s ease;
    color: var(--color-text-dim);
    cursor: pointer;
    background: var(--color-bg-elevated);
    border: 1px solid var(--color-border);
    border-bottom: none;
    margin-bottom: -1px;
    position: relative;
    clip-path: polygon(
      0 0,
      100% 0,
      100% calc(100% - 10px),
      calc(100% - 10px) 100%,
      0 100%
    );
  }

  .tab::after {
    content: '';
    position: absolute;
    bottom: 0;
    right: 0;
    width: 14px;
    height: 1px;
    background: var(--color-accent);
    transform-origin: bottom right;
    transform: rotate(-45deg) translateY(-0.5px);
    opacity: 0.4;
  }

  .tab:hover {
    color: var(--color-text);
    background: var(--color-bg-hover);
    border-color: var(--color-border-hover);
  }

  .tab:hover::after {
    opacity: 0.8;
  }

  .tab-active,
  .tab.active {
    color: var(--color-accent);
    background: var(--color-bg-surface);
    border-color: var(--color-accent);
    box-shadow:
      inset 0 2px 0 var(--color-accent),
      inset 2px 0 0 var(--color-accent),
      inset -2px 0 0 var(--color-accent);
  }

  .tab-active::after,
  .tab.active::after {
    opacity: 1;
    background: var(--color-accent);
    height: 2px;
    width: 16px;
  }

  /* ---------- Statblock Styling ---------- */
  .statblock {
    font-size: var(--text-base);
    line-height: 1.6;
    color: var(--color-text);
  }

  .statblock hr {
    border: none;
    border-top: 1px solid var(--color-border);
    margin: 0.5rem 0;
  }

  .statblock strong,
  .statblock b {
    color: var(--color-stat-label);
    font-weight: 600;
  }

  .stat-line {
    margin-bottom: 0.25rem;
  }

  .stat-section {
    margin-bottom: 0.5rem;
  }

  /* ---------- Attack/Ability Blocks ---------- */
  .attack-block {
    padding: 0.625rem;
    margin: 0.5rem 0;
    background: var(--color-accent-subtle);
    border-radius: var(--radius);
    border-left: 3px solid var(--color-accent);
    transition: background-color 0.15s ease;
  }

  .attack-block:hover {
    background: rgba(88, 166, 255, 0.15);
  }

  .ability-block {
    padding: 0.625rem;
    margin: 0.5rem 0;
    background: var(--color-hazard-subtle);
    border-radius: var(--radius);
    border-left: 3px solid var(--color-hazard);
    transition: background-color 0.15s ease;
  }

  /* ---------- Action Icons ---------- */
  .action-icon {
    display: inline-block;
    width: 1em;
    height: 1em;
    vertical-align: middle;
    margin: 0 0.125rem;
  }

  /* ---------- Roll Toast ---------- */
  .roll-toast {
    position: fixed;
    bottom: 2rem;
    right: 2rem;
    background: var(--color-bg-elevated);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: 1rem 1.5rem;
    box-shadow: var(--shadow-lg);
    z-index: 1000;
    animation: var(--animate-slide-in);
  }

  .roll-toast-name {
    font-size: var(--text-sm);
    color: var(--color-text-dim);
    margin-bottom: 0.25rem;
  }

  .roll-toast-result {
    font-size: var(--text-2xl);
    font-weight: 700;
    color: var(--color-rollable);
  }

  .roll-toast-breakdown {
    font-size: var(--text-sm);
    color: var(--color-text-muted);
    margin-top: 0.25rem;
    font-family: monospace;
  }

  /* ---------- Lists ---------- */
  .list-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem;
    border-radius: var(--radius);
    transition: all 0.15s ease;
  }

  .list-item:hover {
    background: var(--color-bg-elevated);
  }

  .list-item-selected {
    background: var(--color-accent-subtle);
    border-left: 3px solid var(--color-accent);
  }

  /* ---------- Progress/Budget Bar ---------- */
  .budget-bar {
    position: relative;
    height: 0.5rem;
    background: var(--color-border);
    border-radius: 9999px;
    overflow: visible;
  }

  .budget-bar-fill {
    height: 100%;
    border-radius: 9999px;
    transition: all 0.3s ease;
  }

  .budget-marker {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 2px;
    height: 0.75rem;
    background: var(--color-text-muted);
  }

  /* ---------- HP Bar ---------- */
  .hp-bar {
    position: relative;
    height: 1.75rem;
    background: var(--color-bg);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    overflow: hidden;
  }

  .hp-bar-fill {
    position: absolute;
    inset: 0;
    right: auto;
    transition: all 0.3s ease;
    border-radius: var(--radius-sm);
  }

  .hp-bar-text {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: var(--text-md);
    font-weight: 700;
    font-family: var(--font-mono);
    color: white;
    text-shadow:
      0 0 4px rgba(0, 0, 0, 0.9),
      0 1px 2px rgba(0, 0, 0, 0.9),
      1px 1px 0 rgba(0, 0, 0, 0.7),
      -1px -1px 0 rgba(0, 0, 0, 0.7);
    letter-spacing: 0.05em;
  }

  /* HP Controls - damage/heal input */
  .hp-controls {
    display: flex;
    align-items: center;
    gap: 0;
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    overflow: hidden;
    background: var(--color-bg-elevated);
  }

  .hp-btn {
    width: 1.5rem;
    height: 1.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: var(--text-lg);
    font-weight: 700;
    border: none;
    cursor: pointer;
    transition: all 0.15s ease;
    padding: 0;
    line-height: 1;
  }

  .hp-btn-damage {
    background: var(--color-danger);
    color: white;
  }

  .hp-btn-damage:hover {
    background: var(--color-danger-dim);
  }

  .hp-btn-heal {
    background: var(--color-success);
    color: white;
  }

  .hp-btn-heal:hover {
    background: var(--color-success-dim);
  }

  .hp-input {
    width: 2.5rem;
    height: 1.5rem;
    text-align: center;
    font-size: var(--text-sm);
    font-family: var(--font-mono);
    font-weight: 600;
    border: none;
    background: var(--color-bg-surface);
    color: var(--color-text);
    padding: 0 0.25rem;
    -moz-appearance: textfield;
  }

  .hp-input::-webkit-outer-spin-button,
  .hp-input::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }

  .hp-input::placeholder {
    color: var(--color-text-muted);
  }

  .hp-input:focus {
    outline: none;
    background: var(--color-bg);
  }

  /* ---------- Count Controls ---------- */
  .count-control {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    background: var(--color-bg-elevated);
    border-radius: var(--radius);
    border: 1px solid var(--color-border);
  }

  .count-btn {
    width: 1.75rem;
    height: 1.75rem;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--color-text-dim);
    transition: all 0.15s ease;
    font-size: var(--text-lg);
    font-weight: 500;
    cursor: pointer;
    background: transparent;
    border: none;
  }

  .count-btn:hover {
    color: var(--color-text);
    background: var(--color-bg-hover);
  }

  .count-value {
    width: 2rem;
    text-align: center;
    font-size: var(--text-md);
    font-weight: 600;
    color: var(--color-text);
  }

  /* ---------- Adjustment Radio ---------- */
  .adjustment-group {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    font-size: var(--text-sm);
  }

  .adjustment-option {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    cursor: pointer;
    color: var(--color-text-dim);
    transition: color 0.15s ease;
  }

  .adjustment-option:hover {
    color: var(--color-text);
  }

  .adjustment-option input[type="radio"] {
    width: 0.875rem;
    height: 0.875rem;
    accent-color: var(--color-accent);
  }

  .adjustment-option.selected {
    color: var(--color-accent);
  }

  /* ---------- Complexity/Type Badges ---------- */
  .badge-simple {
    background: var(--color-bg-elevated);
    color: var(--color-text-dim);
    border: 1px solid var(--color-border);
    padding: 0.125rem 0.375rem;
    font-size: var(--text-xs);
    border-radius: var(--radius-sm);
  }

  .badge-complex {
    background: var(--color-warning-subtle);
    color: var(--color-warning);
    border: 1px solid rgba(210, 153, 34, 0.5);
    padding: 0.125rem 0.375rem;
    font-size: var(--text-xs);
    border-radius: var(--radius-sm);
  }

  .badge-trap {
    background: var(--color-danger-subtle);
    color: var(--color-danger);
    border: 1px solid rgba(248, 81, 73, 0.5);
    padding: 0.125rem 0.375rem;
    font-size: var(--text-xs);
    border-radius: var(--radius-sm);
  }

  .badge-environmental {
    background: var(--color-success-subtle);
    color: var(--color-success);
    border: 1px solid rgba(63, 185, 80, 0.5);
    padding: 0.125rem 0.375rem;
    font-size: var(--text-xs);
    border-radius: var(--radius-sm);
  }

  .badge-haunt {
    background: var(--color-hazard-subtle);
    color: var(--color-hazard);
    border: 1px solid rgba(168, 85, 247, 0.5);
    padding: 0.125rem 0.375rem;
    font-size: var(--text-xs);
    border-radius: var(--radius-sm);
  }

  /* XP Badge */
  .badge-xp {
    background: var(--color-accent-subtle);
    color: var(--color-accent);
    border: 1px solid rgba(88, 166, 255, 0.5);
    padding: 0.125rem 0.5rem;
    font-size: var(--text-xs);
    font-weight: 600;
    border-radius: var(--radius-sm);
  }
}

/* ============================================
   UTILITIES - Custom utility classes
   ============================================ */
@layer utilities {
  /* Accent border variants */
  .border-l-accent-3 {
    border-left: 3px solid var(--color-accent);
  }

  .border-l-success-3 {
    border-left: 3px solid var(--color-success);
  }

  .border-l-danger-3 {
    border-left: 3px solid var(--color-danger);
  }

  .border-l-warning-3 {
    border-left: 3px solid var(--color-warning);
  }

  .border-l-hazard-3 {
    border-left: 3px solid var(--color-hazard);
  }

  /* Text truncation */
  .truncate-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* Scrollable containers */
  .scrollable {
    overflow: auto;
    scrollbar-gutter: stable;
  }

  .scrollable-x {
    overflow-x: auto;
    overflow-y: hidden;
  }

  /* Hide scrollbar but keep functionality */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* Gradient text */
  .text-gradient-accent {
    background: linear-gradient(to right, var(--color-accent), var(--color-accent-bright));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  /* Glass effect */
  .glass {
    background: rgba(22, 27, 34, 0.8);
    backdrop-filter: blur(12px);
  }

  /* Text colors */
  .text-dim { color: var(--color-text-dim); }
  .text-muted { color: var(--color-text-muted); }
  .text-accent { color: var(--color-accent); }
  .text-success { color: var(--color-success); }
  .text-warning { color: var(--color-warning); }
  .text-danger { color: var(--color-danger); }
  .text-rollable { color: var(--color-rollable); }
  .text-hazard { color: var(--color-hazard); }

  /* Background colors */
  .bg-bg { background-color: var(--color-bg); }
  .bg-surface { background-color: var(--color-bg-surface); }
  .bg-elevated { background-color: var(--color-bg-elevated); }
  .bg-accent { background-color: var(--color-accent); }
  .bg-success { background-color: var(--color-success); }
  .bg-warning { background-color: var(--color-warning); }
  .bg-danger { background-color: var(--color-danger); }
  .bg-hazard { background-color: var(--color-hazard); }
  .bg-dim { background-color: var(--color-text-dim); }
  .bg-accent-subtle { background-color: var(--color-accent-subtle); }
  .bg-success-subtle { background-color: var(--color-success-subtle); }
  .bg-warning-subtle { background-color: var(--color-warning-subtle); }
  .bg-danger-subtle { background-color: var(--color-danger-subtle); }
  .bg-hazard-subtle { background-color: var(--color-hazard-subtle); }

  /* Border colors */
  .border-border { border-color: var(--color-border); }
  .border-accent { border-color: var(--color-accent); }
  .border-success { border-color: var(--color-success); }
  .border-warning { border-color: var(--color-warning); }
  .border-danger { border-color: var(--color-danger); }
  .border-hazard { border-color: var(--color-hazard); }

  /* Difficulty display classes (for encounter builder) */
  .difficulty {
    display: inline-block;
    padding: 0.25rem 0.75rem;
    font-size: var(--text-sm);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    border-radius: var(--radius-sm);
    color: white;
  }

  .difficulty-trivial { background: var(--color-trivial); }
  .difficulty-low { background: var(--color-low); }
  .difficulty-moderate { background: var(--color-moderate); }
  .difficulty-severe { background: var(--color-severe); }
  .difficulty-extreme { background: var(--color-extreme); }

  /* Border width utilities */
  .border-l-3 { border-left-width: 3px; }
  .border-l-accent { border-left-color: var(--color-accent); }
  .border-l-success { border-left-color: var(--color-success); }
  .border-l-danger { border-left-color: var(--color-danger); }
  .border-l-warning { border-left-color: var(--color-warning); }
  .border-l-hazard { border-left-color: var(--color-hazard); }
}
